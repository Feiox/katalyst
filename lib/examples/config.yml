listener:
  interface: "0.0.0.0:8000"

hosts:
  echo:
    servers:
      - "https://postman-echo.com"

routes:
  - pattern: "^/test/(?P<cap>.*)$"
    methods:
      - get
    downstream:
      host: echo
      path: "/get?env_user={{env=>USER}}&regex_cap={{regex=>cap}}&method={{http=>method}}&ip={{http=>ip}}&header={{header=>user-agent}}&claim={{claim=>KatalystAuthenticator}}"
    authenticators:
      - backend: always

  - pattern: "^/test/post$"
    methods:
      - post
    downstream:
      host: echo
      path: "/get?foo1=bar"
    authenticators:
      - backend: never
